<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AnläggningsID Från Faktura</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="" />

</head>
<body>


<h1>Verktygslåda<h1>
  <h3>Formatera anläggningsID<h3>
    <div></div>
    <input type="text" id="string">
    <button type="button" onclick="clickHandler()">Kopiera</button>

    <h1 id="output">


      <script>
        function clickHandler() {
          let stringToChange = document.getElementById("string")
          let stringValue = stringToChange.value
          let sliced = ""
          let y = 0
          let z = 0
          let j = 0
          let omID
          var temp = ""
          stringValue = stringValue.replace(/\s+/g, '')
          let stringLength = stringValue.length
          harOmID = stringValue[0] + stringValue[1] + stringValue[2]
          omradesIdn = "ABB\n" +
                  "AHB\n" +
                  "AJB\n" +
                  "AKB\n" +
                  "ALL\n" +
                  "ALM\n" +
                  "ALS\n" +
                  "ALV\n" +
                  "AML\n" +
                  "AMS\n" +
                  "ANE\n" +
                  "ANG\n" +
                  "ARD\n" +
                  "ARN\n" +
                  "ARS\n" +
                  "ARV\n" +
                  "ASL\n" +
                  "AVD\n" +
                  "AVE\n" +
                  "BDL\n" +
                  "BDN\n" +
                  "BEF\n" +
                  "BGO\n" +
                  "BHM\n" +
                  "BJK\n" +
                  "BJL\n" +
                  "BJR\n" +
                  "BKE\n" +
                  "BLE\n" +
                  "BMA\n" +
                  "BOO\n" +
                  "BRG\n" +
                  "BRL\n" +
                  "BRS\n" +
                  "BYG\n" +
                  "CBR\n" +
                  "DAD\n" +
                  "DAN\n" +
                  "DAP\n" +
                  "DFS\n" +
                  "DOF\n" +
                  "DRV\n" +
                  "EBA\n" +
                  "EBN\n" +
                  "EKG\n" +
                  "EKO\n" +
                  "ESJ\n" +
                  "ESK\n" +
                  "FBG\n" +
                  "FBN\n" +
                  "FGA\n" +
                  "FLE\n" +
                  "FLN\n" +
                  "FLO\n" +
                  "FMD\n" +
                  "FOB\n" +
                  "FPD\n" +
                  "FRV\n" +
                  "FSB\n" +
                  "GAB\n" +
                  "GAM\n" +
                  "GBG\n" +
                  "GBN\n" +
                  "GDB\n" +
                  "GIV\n" +
                  "GNF\n" +
                  "GTA\n" +
                  "GTL\n" +
                  "GTP\n" +
                  "GVL\n" +
                  "HAL\n" +
                  "HAM\n" +
                  "HBG\n" +
                  "HBO\n" +
                  "HBY\n" +
                  "HDG\n" +
                  "HDL\n" +
                  "HDS\n" +
                  "HDV\n" +
                  "HJM\n" +
                  "HJN\n" +
                  "HJO\n" +
                  "HLB\n" +
                  "HLD\n" +
                  "HLJ\n" +
                  "HMD\n" +
                  "HMH\n" +
                  "HMM\n" +
                  "HMR\n" +
                  "HOF\n" +
                  "HOG\n" +
                  "HOR\n" +
                  "HRA\n" +
                  "HSD\n" +
                  "HUV\n" +
                  "HVI\n" +
                  "ING\n" +
                  "JML\n" +
                  "JNK\n" +
                  "JRA\n" +
                  "JUJ\n" +
                  "KAB\n" +
                  "KBA\n" +
                  "KBG\n" +
                  "KHB\n" +
                  "KHN\n" +
                  "KKA\n" +
                  "KKB\n" +
                  "KLK\n" +
                  "KMR\n" +
                  "KND\n" +
                  "KOB\n" +
                  "KPN\n" +
                  "KRF\n" +
                  "KRH\n" +
                  "KRS\n" +
                  "KSA\n" +
                  "KST\n" +
                  "KUV\n" +
                  "KVI\n" +
                  "KVM\n" +
                  "LAO\n" +
                  "LBY\n" +
                  "LDB\n" +
                  "LDG\n" +
                  "LDK\n" +
                  "LED\n" +
                  "LER\n" +
                  "LHM\n" +
                  "LJD\n" +
                  "LKA\n" +
                  "LMA\n" +
                  "LNK\n" +
                  "LRM\n" +
                  "LUL\n" +
                  "LUN\n" +
                  "LYS\n" +
                  "LYX\n" +
                  "MAF\n" +
                  "MAI\n" +
                  "MBT\n" +
                  "MBY\n" +
                  "MDL\n" +
                  "MEL\n" +
                  "MLG\n" +
                  "MMO\n" +
                  "MOR\n" +
                  "MRP\n" +
                  "MSD\n" +
                  "MYN\n" +
                  "NBL\n" +
                  "NBR\n" +
                  "NHA\n" +
                  "NHN\n" +
                  "NKL\n" +
                  "NOB\n" +
                  "NRL\n" +
                  "NSB\n" +
                  "NSF\n" +
                  "NSO\n" +
                  "NTE\n" +
                  "NVS\n" +
                  "NYD\n" +
                  "NYK\n" +
                  "OBO\n" +
                  "OCK\n" +
                  "OFB\n" +
                  "OGO\n" +
                  "OHM\n" +
                  "OHN\n" +
                  "OLD\n" +
                  "OLN\n" +
                  "OLS\n" +
                  "ORT\n" +
                  "ORV\n" +
                  "OSD\n" +
                  "OVK\n" +
                  "OXD\n" +
                  "PIB\n" +
                  "PTE\n" +
                  "RBY\n" +
                  "ROY\n" +
                  "RSJ\n" +
                  "RSK\n" +
                  "SAH\n" +
                  "SBG\n" +
                  "SBK\n" +
                  "SBR\n" +
                  "SBV\n" +
                  "SDT\n" +
                  "SDV\n" +
                  "SFE\n" +
                  "SFP\n" +
                  "SGD\n" +
                  "SGS\n" +
                  "SHD\n" +
                  "SHN\n" +
                  "SHT\n" +
                  "SIG\n" +
                  "SIH\n" +
                  "SJB\n" +
                  "SJO\n" +
                  "SKA\n" +
                  "SKD\n" +
                  "SKL\n" +
                  "SKN\n" +
                  "SKP\n" +
                  "SKR\n" +
                  "SKT\n" +
                  "SKV\n" +
                  "SLD\n" +
                  "SMB\n" +
                  "SMN\n" +
                  "SMS\n" +
                  "SNM\n" +
                  "SOT\n" +
                  "SRF\n" +
                  "SSJ\n" +
                  "STH\n" +
                  "STR\n" +
                  "SUV\n" +
                  "SYM\n" +
                  "TBA\n" +
                  "TBG\n" +
                  "TBY\n" +
                  "TDN\n" +
                  "TDO\n" +
                  "THM\n" +
                  "TIB\n" +
                  "TLB\n" +
                  "TNN\n" +
                  "TNS\n" +
                  "TOR\n" +
                  "TOS\n" +
                  "TRE\n" +
                  "TRH\n" +
                  "TRS\n" +
                  "TUM\n" +
                  "TYR\n" +
                  "TYS\n" +
                  "UHN\n" +
                  "UMA\n" +
                  "UMD\n" +
                  "UMO\n" +
                  "UPN\n" +
                  "UPO\n" +
                  "UPP\n" +
                  "UPS\n" +
                  "UPV\n" +
                  "URM\n" +
                  "UVA\n" +
                  "VAB\n" +
                  "VAD\n" +
                  "VAG\n" +
                  "VAL\n" +
                  "VAN\n" +
                  "VAR\n" +
                  "VAT\n" +
                  "VBG\n" +
                  "VBK\n" +
                  "VBL\n" +
                  "VBN\n" +
                  "VBS\n" +
                  "VBY\n" +
                  "VDM\n" +
                  "VDN\n" +
                  "VGD\n" +
                  "VGF\n" +
                  "VIG\n" +
                  "VLB\n" +
                  "VLS\n" +
                  "VMA\n" +
                  "VMD\n" +
                  "VMO\n" +
                  "VNB\n" +
                  "VTL\n" +
                  "VVI\n" +
                  "VXO\n" +
                  "YST"
          harDe = omradesIdn.includes(harOmID)

          if (stringValue.includes('JanFebMarAprMajJunJulAugSepOktNovDec') && stringValue.includes('735999')) {

            for (let i = 0, x = 0; i < stringLength; i++) {
              if (sliced === ':' && stringValue[x+18] === 'O' && stringValue[x] === '7' && stringValue[x+1] === '3' && stringValue[x+2] === '5' && stringValue[x+3] === '9' && stringValue[x+4] === '9' && stringValue[x+5] === '9' && (stringValue[x+17] >= '0' && stringValue[x+17] <= '9') && (stringValue[x+16] >= '0' && stringValue[x+16] <= '9') && (stringValue[x+15] >= '0' && stringValue[x+15] <= '9') && (stringValue[x+14] >= '0' && stringValue[x+14] <= '9') && (stringValue[x+13] >= '0' && stringValue[x+13] <= '9') && (stringValue[x+12] >= '0' && stringValue[x+12] <= '9') && (stringValue[x+11] >= '0' && stringValue[x+11] <= '9') && (stringValue[x+10] >= '0' && stringValue[x+10] <= '9') && (stringValue[x+9] >= '0' && stringValue[x+9] <= '9')) {
                i = stringLength
              } else {
                sliced = stringValue[x]
                stringValue = stringValue.split('')
                stringValue.splice(x, 1, '')
                stringValue = stringValue.join('')
              }
            }
            for (let i = 17, x = 18; i < stringLength; i++) {
              harOmID = stringValue[19] + stringValue[20] + stringValue[21]
              if(omradesIdn.includes(harOmID)) {
                omID = stringValue.slice(x+1, x+4)
                stringValue = stringValue.slice(0, x)
                stringValue = omID + stringValue
                i = stringLength
              } else {
                stringValue = stringValue.split('')
                stringValue.splice(x, 1, '')
                stringValue = stringValue.join('')
              }
            }


          } else if (stringValue[0] !== '7' && stringValue[1] !== '3' && stringValue[2] !== '5') {
            for (let i = 0; i < stringLength; i++) {
               //if(stringValue[j] === '1' && (stringValue[j+11] >= '0' && stringValue[j+11] <= '9') && (stringValue[j+10] >= '0' && stringValue[j+10] <= '9') && (stringValue[j+9] >= '0' && stringValue[j+9] <= '9') && (stringValue[j+8] >= '0' && stringValue[j+8] <= '9') && (stringValue[j+7] >= '0' && stringValue[j+7] <= '9') && (stringValue[j+6] >= '0' && stringValue[j+6] <= '9') && (stringValue[j+5] >= '0' && stringValue[j+5] <= '9') && (stringValue[j+4] >= '0' && stringValue[j+4] <= '9') && (stringValue[j+3] >= '0' && stringValue[j+3] <= '9') && (stringValue[j+2] >= '0' && stringValue[j+2] <= '9') && (stringValue[j+1] >= '0' && stringValue[j+1] <= '9')) {
                //stringValue = stringValue.split('')
                //stringValue.splice(j, 0, '735999')
                //stringValue = stringValue.join('')
                //stringLength += 6
              //}
              if (stringValue[j] === '7' && stringValue[j+1] === '3' && stringValue[j+2] === '5' && stringValue[j+3] === '9' && stringValue[j+4] === '9' && stringValue[j+5] === '9' && (stringValue[j+17] >= '0' && stringValue[j+17] <= '9') && (stringValue[j+16] >= '0' && stringValue[j+16] <= '9') && (stringValue[j+15] >= '0' && stringValue[j+15] <= '9') && (stringValue[j+14] >= '0' && stringValue[j+14] <= '9') && (stringValue[j+13] >= '0' && stringValue[j+13] <= '9') && (stringValue[j+12] >= '0' && stringValue[j+12] <= '9') && (stringValue[j+11] >= '0' && stringValue[j+11] <= '9') && (stringValue[j+10] >= '0' && stringValue[j+10] <= '9') && (stringValue[j+9] >= '0' && stringValue[j+9] <= '9')) {
                y += 18
                sliced = stringValue.slice(z, y)
                temp += '*' + sliced + '\n'
                z += 18
                i += 17
                j += 18
              } else if (omradesIdn.includes(stringValue[j] + stringValue[j+1] + stringValue[j+2]) && stringValue[j+3] === '7' && stringValue[j+4] === '3' && stringValue[j+5] === '5' && stringValue[j+6] === '9') {
                y += 21
                sliced = stringValue.slice(z, y)
                temp += sliced + '\n'
                z += 21
                i += 20
                j += 21
              } else {
                stringValue = stringValue.split('')
                stringValue.splice(j, 1, '')
                stringValue = stringValue.join('')
              }
            }
            stringValue = temp
          }


          // Borde egentligen ta bort eller ändra
          if (stringValue[0] === "7") {
            var numberOfPods = stringValue.length / 18
            y = 18
            if (stringValue.length > 18) {
              for (var x = 0; x < numberOfPods; x++, y += 18, z += 18) {
                sliced = stringValue.slice(z, y)
                temp += '*' + sliced + '\n'

              }
              stringValue = temp
            } else {
              stringValue = '*' + stringValue
            }

          }


          var outputjs = document.getElementById("output")
          if (stringValue === '' || omID === '') {
            outputjs.innerText = 'Inget anläggningsID hittat.'
          } else {
            outputjs.innerText = stringValue
            navigator.clipboard.writeText(stringValue)
          }
        }
      </script>
</body>
</html>